{"ast":null,"code":"import{analyticsService}from'./analytics';import{webinarApi}from'./webinarApi';export function loadRazorpay(){let src=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'https://checkout.razorpay.com/v1/checkout.js';return new Promise((resolve,reject)=>{if(document.querySelector(`script[src=\"${src}\"]`)){resolve(true);return;}const script=document.createElement('script');script.src=src;script.onload=()=>resolve(true);script.onerror=()=>reject(new Error('Failed to load Razorpay'));document.body.appendChild(script);});}// Webinar-specific checkout (existing functionality)\nexport async function openRazorpayCheckout(_ref){let{name,email,phone,amount=99,onSuccess,onFailure}=_ref;const loaded=await loadRazorpay();if(!loaded)throw new Error('Razorpay SDK failed to load');const options={key:process.env.REACT_APP_RAZORPAY_KEY_ID,amount:amount*100,// in paise\ncurrency:'INR',name:'Vibe Coding Webinar',description:'Registration Fee',image:'/favicon.ico',handler:function(response){onSuccess===null||onSuccess===void 0?void 0:onSuccess(response);},prefill:{name,email,contact:phone},notes:{purpose:'Webinar Registration',webinarDate:'2024-09-22'},theme:{color:'#667eea'}};const rzp=new window.Razorpay(options);rzp.on('payment.failed',function(response){onFailure===null||onFailure===void 0?void 0:onFailure(response.error);});rzp.open();}// Generic subscription checkout with Cloud Functions\nexport async function openSubscriptionCheckout(orderData,options){try{var _orderData$notes;const loaded=await loadRazorpay();if(!loaded)throw new Error('Razorpay SDK failed to load');// Create order via Firebase Cloud Functions\nconst order=await webinarApi.createRazorpayOrder(orderData);options.order_id=order.id;// Track payment initiation\nawait analyticsService.trackEvent('payment_initiated',{amount:orderData.amount,currency:orderData.currency,tier:(_orderData$notes=orderData.notes)===null||_orderData$notes===void 0?void 0:_orderData$notes.tier,orderId:order.id});// Open Razorpay checkout\nconst razorpay=new window.Razorpay(options);razorpay.open();}catch(error){console.error('Error opening Razorpay checkout:',error);throw error;}}","map":{"version":3,"names":["analyticsService","webinarApi","loadRazorpay","src","arguments","length","undefined","Promise","resolve","reject","document","querySelector","script","createElement","onload","onerror","Error","body","appendChild","openRazorpayCheckout","_ref","name","email","phone","amount","onSuccess","onFailure","loaded","options","key","process","env","REACT_APP_RAZORPAY_KEY_ID","currency","description","image","handler","response","prefill","contact","notes","purpose","webinarDate","theme","color","rzp","window","Razorpay","on","error","open","openSubscriptionCheckout","orderData","_orderData$notes","order","createRazorpayOrder","order_id","id","trackEvent","tier","orderId","razorpay","console"],"sources":["/Users/prakash/Documents/vibe-coding/src/services/razorpay.js"],"sourcesContent":["import { analyticsService } from './analytics';\nimport { webinarApi } from './webinarApi';\n\nexport function loadRazorpay(src = 'https://checkout.razorpay.com/v1/checkout.js') {\n  return new Promise((resolve, reject) => {\n    if (document.querySelector(`script[src=\"${src}\"]`)) {\n      resolve(true);\n      return;\n    }\n    const script = document.createElement('script');\n    script.src = src;\n    script.onload = () => resolve(true);\n    script.onerror = () => reject(new Error('Failed to load Razorpay'));\n    document.body.appendChild(script);\n  });\n}\n\n// Webinar-specific checkout (existing functionality)\nexport async function openRazorpayCheckout({ name, email, phone, amount = 99, onSuccess, onFailure }) {\n  const loaded = await loadRazorpay();\n  if (!loaded) throw new Error('Razorpay SDK failed to load');\n\n  const options = {\n    key: process.env.REACT_APP_RAZORPAY_KEY_ID,\n    amount: amount * 100, // in paise\n    currency: 'INR',\n    name: 'Vibe Coding Webinar',\n    description: 'Registration Fee',\n    image: '/favicon.ico',\n    handler: function (response) {\n      onSuccess?.(response);\n    },\n    prefill: {\n      name,\n      email,\n      contact: phone,\n    },\n    notes: {\n      purpose: 'Webinar Registration',\n      webinarDate: '2024-09-22',\n    },\n    theme: {\n      color: '#667eea',\n    },\n  };\n\n  const rzp = new window.Razorpay(options);\n  rzp.on('payment.failed', function (response) {\n    onFailure?.(response.error);\n  });\n  rzp.open();\n}\n\n// Generic subscription checkout with Cloud Functions\nexport async function openSubscriptionCheckout(orderData, options) {\n  try {\n    const loaded = await loadRazorpay();\n    if (!loaded) throw new Error('Razorpay SDK failed to load');\n\n    // Create order via Firebase Cloud Functions\n    const order = await webinarApi.createRazorpayOrder(orderData);\n    options.order_id = order.id;\n\n    // Track payment initiation\n    await analyticsService.trackEvent('payment_initiated', {\n      amount: orderData.amount,\n      currency: orderData.currency,\n      tier: orderData.notes?.tier,\n      orderId: order.id\n    });\n\n    // Open Razorpay checkout\n    const razorpay = new window.Razorpay(options);\n    razorpay.open();\n\n  } catch (error) {\n    console.error('Error opening Razorpay checkout:', error);\n    throw error;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}