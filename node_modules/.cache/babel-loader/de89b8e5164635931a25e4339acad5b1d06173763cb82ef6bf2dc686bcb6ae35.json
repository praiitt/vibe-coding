{"ast":null,"code":"import { analyticsService } from './analytics';\nimport { webinarApi } from './webinarApi';\nexport function loadRazorpay(src = 'https://checkout.razorpay.com/v1/checkout.js') {\n  return new Promise((resolve, reject) => {\n    if (document.querySelector(`script[src=\"${src}\"]`)) {\n      resolve(true);\n      return;\n    }\n    const script = document.createElement('script');\n    script.src = src;\n    script.onload = () => resolve(true);\n    script.onerror = () => reject(new Error('Failed to load Razorpay'));\n    document.body.appendChild(script);\n  });\n}\n\n// Webinar-specific checkout (existing functionality)\nexport async function openRazorpayCheckout({\n  name,\n  email,\n  phone,\n  amount = 99,\n  onSuccess,\n  onFailure\n}) {\n  const loaded = await loadRazorpay();\n  if (!loaded) throw new Error('Razorpay SDK failed to load');\n  const options = {\n    key: process.env.REACT_APP_RAZORPAY_KEY_ID,\n    amount: amount * 100,\n    // in paise\n    currency: 'INR',\n    name: 'Vibe Coding Webinar',\n    description: 'Registration Fee',\n    image: '/favicon.ico',\n    handler: function (response) {\n      onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess(response);\n    },\n    prefill: {\n      name,\n      email,\n      contact: phone\n    },\n    notes: {\n      purpose: 'Webinar Registration',\n      webinarDate: '2024-09-22'\n    },\n    theme: {\n      color: '#667eea'\n    }\n  };\n  const rzp = new window.Razorpay(options);\n  rzp.on('payment.failed', function (response) {\n    onFailure === null || onFailure === void 0 ? void 0 : onFailure(response.error);\n  });\n  rzp.open();\n}\n\n// Generic subscription checkout with Cloud Functions\nexport async function openSubscriptionCheckout(orderData, options) {\n  try {\n    var _orderData$notes;\n    const loaded = await loadRazorpay();\n    if (!loaded) throw new Error('Razorpay SDK failed to load');\n\n    // Create order via Firebase Cloud Functions\n    const order = await webinarApi.createRazorpayOrder(orderData);\n    options.order_id = order.id;\n\n    // Track payment initiation\n    await analyticsService.trackEvent('payment_initiated', {\n      amount: orderData.amount,\n      currency: orderData.currency,\n      tier: (_orderData$notes = orderData.notes) === null || _orderData$notes === void 0 ? void 0 : _orderData$notes.tier,\n      orderId: order.id\n    });\n\n    // Open Razorpay checkout\n    const razorpay = new window.Razorpay(options);\n    razorpay.open();\n  } catch (error) {\n    console.error('Error opening Razorpay checkout:', error);\n    throw error;\n  }\n}","map":{"version":3,"names":["analyticsService","webinarApi","loadRazorpay","src","Promise","resolve","reject","document","querySelector","script","createElement","onload","onerror","Error","body","appendChild","openRazorpayCheckout","name","email","phone","amount","onSuccess","onFailure","loaded","options","key","process","env","REACT_APP_RAZORPAY_KEY_ID","currency","description","image","handler","response","prefill","contact","notes","purpose","webinarDate","theme","color","rzp","window","Razorpay","on","error","open","openSubscriptionCheckout","orderData","_orderData$notes","order","createRazorpayOrder","order_id","id","trackEvent","tier","orderId","razorpay","console"],"sources":["/Users/prakash/Documents/vibe-coding/src/services/razorpay.js"],"sourcesContent":["import { analyticsService } from './analytics';\nimport { webinarApi } from './webinarApi';\n\nexport function loadRazorpay(src = 'https://checkout.razorpay.com/v1/checkout.js') {\n  return new Promise((resolve, reject) => {\n    if (document.querySelector(`script[src=\"${src}\"]`)) {\n      resolve(true);\n      return;\n    }\n    const script = document.createElement('script');\n    script.src = src;\n    script.onload = () => resolve(true);\n    script.onerror = () => reject(new Error('Failed to load Razorpay'));\n    document.body.appendChild(script);\n  });\n}\n\n// Webinar-specific checkout (existing functionality)\nexport async function openRazorpayCheckout({ name, email, phone, amount = 99, onSuccess, onFailure }) {\n  const loaded = await loadRazorpay();\n  if (!loaded) throw new Error('Razorpay SDK failed to load');\n\n  const options = {\n    key: process.env.REACT_APP_RAZORPAY_KEY_ID,\n    amount: amount * 100, // in paise\n    currency: 'INR',\n    name: 'Vibe Coding Webinar',\n    description: 'Registration Fee',\n    image: '/favicon.ico',\n    handler: function (response) {\n      onSuccess?.(response);\n    },\n    prefill: {\n      name,\n      email,\n      contact: phone,\n    },\n    notes: {\n      purpose: 'Webinar Registration',\n      webinarDate: '2024-09-22',\n    },\n    theme: {\n      color: '#667eea',\n    },\n  };\n\n  const rzp = new window.Razorpay(options);\n  rzp.on('payment.failed', function (response) {\n    onFailure?.(response.error);\n  });\n  rzp.open();\n}\n\n// Generic subscription checkout with Cloud Functions\nexport async function openSubscriptionCheckout(orderData, options) {\n  try {\n    const loaded = await loadRazorpay();\n    if (!loaded) throw new Error('Razorpay SDK failed to load');\n\n    // Create order via Firebase Cloud Functions\n    const order = await webinarApi.createRazorpayOrder(orderData);\n    options.order_id = order.id;\n\n    // Track payment initiation\n    await analyticsService.trackEvent('payment_initiated', {\n      amount: orderData.amount,\n      currency: orderData.currency,\n      tier: orderData.notes?.tier,\n      orderId: order.id\n    });\n\n    // Open Razorpay checkout\n    const razorpay = new window.Razorpay(options);\n    razorpay.open();\n\n  } catch (error) {\n    console.error('Error opening Razorpay checkout:', error);\n    throw error;\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}